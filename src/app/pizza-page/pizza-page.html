<div class="container">
  
  <div class="row g-4">
    @for (pizza of pizzasDisponibles(); track pizza.nombre) {
      <div class="col-12 col-md-6 col-lg-4">
        <app-pizza-card 
          [pizza]="pizza"
          (addPizzaEvent)="agregarPizzaAlCarrito($event)" />
      </div>
    }
  </div>

  <hr class="my-5">

  <h2>RESUMEN DEL PEDIDO</h2>

  @if (carrito().length === 0) {
    <p class="text-muted">El carrito está vacío.</p>
  } @else {
    <ul class="list-group mb-3">
      @for (item of carrito(); track item.pizza.nombre) {
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <h6 class="my-0">{{ item.cantidad }} x {{ item.pizza.nombre }}</h6>
          </div>
          <span class="text-success fw-bold">{{ item.subtotal | number: '1.2-2' }} €</span>
        </li>
      }
      <li class="list-group-item d-flex justify-content-between align-items-center fw-bold fs-5">
        <span>Total (EUR)</span>
        <strong class="text-success">{{ calcularTotal() | number: '1.2-2' }} €</strong>
      </li>
    </ul>

    @if (!mostrarPago()) {
      <div class="d-grid">
        <button (click)="togglePago()" class="btn btn-success btn-lg">
          Ir a Pagar
        </button>
      </div>
    }
  }

  @if (mostrarPago()) {
    <hr class="my-4">
    <app-payment-page 
      [carrito]="carrito" 
      (clearCartEvent)="limpiarCarrito()">
    </app-payment-page>
  }
</div>